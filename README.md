Ø§Ù„Ù†Ø¸Ø§Ù… :
Ø§Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ø³ÙŠØ· ÙŠØ­ÙØ¸ Ø§Ù„Ù…Ø³Ø¬Ù„ role = Ù„Ø§Ø¹Ø¨
ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙŠØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙŠÙˆØ¬Ù‡ Ø§Ù„Ù…Ø³Ø¬Ù„ Ø­Ø³Ø¨ Ø§Ù„ role 
Ù„Ùˆ Ù„Ø§Ø¹Ø¨ ÙŠØ±ÙˆØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆÙ„Ùˆ Ù…ÙˆØ¸Ù ÙŠØ±ÙˆØ­ ØµÙØ­Ø© employee
ÙˆÙ„Ùˆ ØµØ§Ø­Ø¨ Ù…Ù„Ø¹Ø¨ ÙŠØ±ÙˆØ­ Ù„ØµÙØ­Ø© Ø§Ù„ owner ÙˆÙ„Ùˆ Ø§Ø¯Ù…Ù† ÙŠØ±ÙˆØ­ Ù„ØµÙØ­Ø© Ø§Ù„admin
Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ±Ø¬Ø¹ Ø§Ù„ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙŠØ£Ø®Ø° ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¹Ù†ÙŠ Ø¨Ø¯ÙˆÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ø§Ø¨ØªØ© Ø®Ø§Ù„Øµ 


Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© : 
ÙŠØ¸Ù‡Ø± ÙÙŠÙ‡Ø§ Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„ÙÙˆØªØ± ÙˆØ§Ø±Ø¨Ø¹ Ø®Ø§Ù†Ø§Øª Ø®Ø§Ù†Ø© Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„ÙƒØ±Ø© ÙˆØ®Ø§Ù†Ø© Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¨Ø§Ø¯Ù„ ÙˆØ®Ø§Ù†Ø© Ù„Ø­Ø¬ÙˆØ²Ø§ØªÙŠ ÙˆØ®Ø§Ù†Ø© Ù„Ø§Ø¶Ø§ÙØ© Ù…Ù„Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯ ÙŠÙ†Ù‚Ù„Ùƒ Ù„Ø¬ÙˆØ¬Ù„ ÙÙˆØ±Ù… 


Ø´ÙƒÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… ÙÙŠ Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„ÙƒØ±Ø© Ù‡Ùˆ Ù†ÙØ³ Ø§Ù„Ù†Ø¸Ø§Ù… ÙÙŠ Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¨Ø§Ø¯Ù„
ØµÙØ­Ø© Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„ÙƒØ±Ø© 
ÙŠØ¹Ø±Ø¶ Ù…Ù„Ø§Ø¹Ø¨ Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ù…ØªØ§Ø­Ø© ÙƒÙ„Ù‡Ø§ ÙƒÙ„ Ù…Ù„Ø¹Ø¨ ÙÙŠ Ø¨Ø·Ø§Ù‚Ø© ÙÙŠÙ‡Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ø¹Ø¨ ÙˆÙ…Ù†Ø·Ù‚ØªÙ‡ ÙˆØªÙØ§ØµÙŠÙ„Ù‡ ÙˆØµÙˆØ±Ø© Ù„Ù„Ù…Ù„Ø¹Ø¨ ÙˆØ²Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ ÙˆØ²Ø± Ø§Ø­Ø¬Ø² Ø§Ù„Ø§Ù† ÙˆØ§Ù„Ø³Ø¹Ø± ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© ÙˆÙƒÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØªÙ… Ø£Ø®Ø°Ù‡Ø§ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªÙ‡ Ù„Ù„Ù…Ù„Ø§Ø¹Ø¨ 
ÙˆÙŠÙƒÙˆÙ† Ø§ÙŠØ¶Ø§ Ù‡Ù†Ø§Ùƒ ÙÙ„ØªØ± Ù„Ù„Ù…Ù„Ø§Ø¹Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© ÙˆÙ‡ÙŠ Ù…ÙˆØ¬ÙˆØ¯Ù‡ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª 
Ø§Ø°Ø§ Ø¶ØºØ· Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¹Ù„ÙŠ Ø²Ø± Ø§Ø­Ø¬Ø² Ø§Ù„Ø§Ù† Ù„Ù„Ù…Ù„Ø¹Ø¨ ÙŠØ°Ù‡Ø¨ Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø¹Ø¨ ÙˆÙ‡ÙŠ ÙÙ„ØªØ± Ù„Ù„Ø§ÙŠØ§Ù… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ ÙˆØ¹Ø±Ø¶ Ù„Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ  ÙƒÙ„ ÙŠÙˆÙ… ÙˆÙ‡Ø°Ù‡ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù…ÙˆØ¬ÙˆØ¯Ù‡ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ù„Ø¹Ø¨ 
ÙˆÙ‡Ù†Ø§Ùƒ Ø¯Ø§Ù„Ø© ØªÙ†Ø´Ø¦ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ø­Ø³Ø¨ Ø§Ù„Ø§ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ù„Ø¹Ø¨ ÙˆÙ‡ÙŠ Ù…ÙˆØ¬ÙˆØ¯Ù‡ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªÙ‡ Ù„Ù„Ù…Ù„Ø¹Ø¨ 















Ø¨Ù„ÙˆØ¨Ø±Ù†Øª ÙƒØ§Ù…Ù„ ÙˆÙ…ØªÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ â€” Ù…Ù† Ø§Ù„Ø£Ù„Ù Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ§Ø¡

(Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ ÙˆØ¨Ø£Ø³Ù„ÙˆØ¨ Ø¹Ù…Ù„ÙŠ Ø¬Ø¯Ø§Ù‹ Ø¨Ø­ÙŠØ« Ø£ÙŠ Ù…Ø·ÙˆÙ‘ÙØ± Ø£Ùˆ Ø£Ø¯Ø§Ø© AI ØªÙ‚Ø¯Ø± ØªÙ†ÙØ°Ù‡ Ø­Ø±ÙÙŠØ§Ù‹ Ø¨Ø¯ÙˆÙ† ØºÙ„Ø·Ø§Øª ØµØºÙŠØ±Ø©)

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ù‡Ùˆ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ÙƒÙ„ Ù…Ù„ÙØŒ ÙƒÙ„ Ø¯Ø§Ù„Ø©ØŒ ÙƒÙ„ API contractØŒ ÙƒÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙƒÙ„ Ù…ØªØºÙŠØ± Ø¨ÙŠØ¦Ø©ØŒ Ø£ÙˆØ§Ù…Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ØŒ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø£Ù…Ø§Ù†ØŒ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©ØŒ ÙˆÙ†Ù‚Ø§Ø· Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡. Ø§Ù†Ø³Ø®Ù‡Ø§ Ø·Ø¨Ù‚-Ø·Ø¨Ù‚ ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹.

Ù†Ø¸Ø±Ø© Ø³Ø±ÙŠØ¹Ø© / Ù‡Ø¯Ù

Ù†Ø¸Ø§Ù… Ø­Ø¬Ø² Ù…Ù„Ø§Ø¹Ø¨ (Soccer & Padel) Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…:

Next.js (App Router) â€” Frontend + Backend (Route Handlers)

Prisma + PostgreSQL

JWT Auth (HttpOnly cookie)

Paymob Ù„Ù„Ø¯ÙØ¹

Minimal, secure, production-ready defaults

1 â€” Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Ø±ÙˆØª ÙƒØ§Ù…Ù„ ÙˆÙ…Ù„ÙØ§Øª)
project-root/
â”œâ”€â”€ app
â”‚   â”œâ”€â”€ (auth)
â”‚   â”‚   â”œâ”€â”€ login
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ register
â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ api
â”‚   â”‚   â”œâ”€â”€ admin
â”‚   â”‚   â”‚   â”œâ”€â”€ manage-users
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ reports
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ stats
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ areas
â”‚   â”‚   â”‚   â””â”€â”€ list
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ auth
â”‚   â”‚   â”‚   â”œâ”€â”€ login
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ logout
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ me
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ refresh
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ register
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ bookings
â”‚   â”‚   â”‚   â”œâ”€â”€ [id]
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ accept
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ cancel
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ create
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ list
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ reject
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ employee
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ manage-bookings
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ fields
â”‚   â”‚   â”‚   â”œâ”€â”€ create
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ details
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ list
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ update
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ owner
â”‚   â”‚   â”‚   â””â”€â”€ fields
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ payments
â”‚   â”‚   â”‚   â”œâ”€â”€ create-session
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ initiate
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ mock-pay
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ webhook
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ schedule
â”‚   â”‚   â”‚   â”œâ”€â”€ generate
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ list
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â””â”€â”€ users
â”‚   â”‚       â””â”€â”€ [id]
â”‚   â”‚           â””â”€â”€ route.ts
â”‚   â”œâ”€â”€ dashboard
â”‚   â”‚   â”œâ”€â”€ admin
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ employee
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ owner
â”‚   â”‚   â”‚   â”œâ”€â”€ [id]
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ player
â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ fields
â”‚   â”‚   â”œâ”€â”€ [id]
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ globals.css
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ my-bookings
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ components
â”‚   â”œâ”€â”€ BookingSlot.tsx
â”‚   â”œâ”€â”€ FieldCard.tsx
â”‚   â”œâ”€â”€ layout
â”‚   â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”‚   â””â”€â”€ Header.tsx
â”‚   â””â”€â”€ ui
â”‚       â”œâ”€â”€ Button.tsx
â”‚       â”œâ”€â”€ Card.tsx
â”‚       â”œâ”€â”€ Input.tsx
â”‚       â”œâ”€â”€ LoadingSpinner.tsx
â”‚       â”œâ”€â”€ Modal.tsx
â”‚       â””â”€â”€ Toast.tsx
â”œâ”€â”€ context
â”‚   â””â”€â”€ AuthContext.tsx
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ helpers.ts
â”‚   â”œâ”€â”€ prisma.ts
â”‚   â””â”€â”€ responses.ts
â”œâ”€â”€ middleware.ts
â”œâ”€â”€ next.config.js
â”œâ”€â”€ package.json
â”œâ”€â”€ postcss.config.js
â”œâ”€â”€ prisma
â”‚   â”œâ”€â”€ schema.prisma
â”‚   â””â”€â”€ seed.ts
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ utils
â”‚   â””â”€â”€ sendMail.js
2 â€” Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Prisma schema) â€” Ù†Ù‡Ø§Ø¦ÙŠ PostgreSQL

Ø§Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù prisma/schema.prisma ÙƒÙ…Ø§ ÙŠÙ„ÙŠ (Ù…Ø¨Ø§Ø´Ø± ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ù€ Postgres):

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
  OWNER
  EMPLOYEE
  ADMIN
}

enum FieldType {
  SOCCER
  PADEL
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  FAILED
}

enum PaymentStatus {
  PENDING
  SUCCESS
  FAILED
}

model User {
  id        String   @id @default(uuid())
  name      String
  email     String   @unique
  password  String
  role      Role     @default(USER)
  createdAt DateTime @default(now())

  fields        Field[]      @relation("OwnerFields")
  bookings      Booking[]
  ownedEmployees Employee[] @relation("OwnerEmployees")
  asEmployee    Employee?    @relation("UserEmployee", fields: [employeeRefId], references: [id])
  employeeRefId String?
}

model Area {
  id     String  @id @default(uuid())
  name   String  @unique
  fields Field[]
}

model Field {
  id           String      @id @default(uuid())
  ownerId      String
  owner        User        @relation("OwnerFields", fields: [ownerId], references: [id])
  name         String
  type         FieldType
  pricePerHour Float
  location     String
  areaId       String
  area         Area        @relation(fields: [areaId], references: [id])
  image        String?
  phone        String?
  description  String?
  createdAt    DateTime    @default(now())

  openHour    String       // "06:00"
  closeHour   String       // "23:00"
  activeDays  Int[]        // 0 = Sun ... 6 = Sat

  schedules    FieldSchedule[]
  bookings     Booking[]
}

model TimeSlot {
  id    String @id @default(uuid())
  start String // "17:00"
  end   String // "18:00"
  label String @unique

  schedules FieldSchedule[]
  bookings  Booking[]
}

model FieldSchedule {
  id        String   @id @default(uuid())
  fieldId   String
  field     Field    @relation(fields: [fieldId], references: [id])
  slotId    String
  slot      TimeSlot @relation(fields: [slotId], references: [id])
  weekday   Int?     // 0..6 or null = every day

  @@unique([fieldId, slotId, weekday], name: "field_slot_weekday_unique")
}

model Booking {
  id             String   @id @default(uuid())
  fieldId        String
  field          Field    @relation(fields: [fieldId], references: [id])
  userId         String
  user           User     @relation(fields: [userId], references: [id])
  date           DateTime // date-only, stored in UTC 00:00
  slotId         String
  slot           TimeSlot @relation(fields: [slotId], references: [id])
  slotLabel      String
  status         BookingStatus @default(PENDING)
  paymentId      String?
  amount         Float
  createdAt      DateTime @default(now())
  cancelledAt    DateTime?
  cancelledBy    String?  // "user" | "employee" | "owner" | "system"
  cancelReason   String?

  payment        Payment? @relation(fields: [paymentId], references: [id])

  @@unique([fieldId, date, slotId], name: "booking_unique_slot_per_field_day")
  @@index([fieldId, date, slotId], name: "booking_field_date_slot_idx")
}

model Payment {
  id            String   @id @default(uuid())
  bookingId     String?
  booking       Booking? @relation(fields: [bookingId], references: [id])
  provider      String   // "paymob"
  providerTxId  String
  status        PaymentStatus
  amount        Float
  createdAt     DateTime @default(now())
}

model Employee {
  id       String   @id @default(uuid())
  ownerId  String
  owner    User     @relation("OwnerEmployees", fields: [ownerId], references: [id])
  userId   String
  user     User     @relation("UserEmployee", fields: [userId], references: [id])

  fieldIds String[]  // array of Field.id
}

3 â€” Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© (Ù…Ù„Ù .env)

Ø§Ù…Ù„Ø£ Ù‡Ø°Ù‡ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„:

DATABASE_URL=postgresql://USER:PASS@HOST:PORT/DBNAME
JWT_SECRET=very_secret_key_here
NEXT_PUBLIC_BASE_URL=http://localhost:3000
PAYMOB_API_KEY=...
PAYMOB_INTEGRATION_ID=...
PAYMOB_IFRAME_ID=...
PAYMOB_CALLBACK_URL=${NEXT_PUBLIC_BASE_URL}/api/payments/webhook

4 â€” Ù…Ù„ÙØ§Øª lib/ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
lib/prisma.ts
import { PrismaClient } from "@prisma/client";
declare global { var prisma: PrismaClient | undefined; }
const prisma = global.prisma ?? new PrismaClient();
if (process.env.NODE_ENV !== "production") global.prisma = prisma;
export default prisma;

lib/auth.ts
import jwt from "jsonwebtoken";
import prisma from "./prisma";

export function signToken(user) {
  return jwt.sign({ id: user.id, role: user.role }, process.env.JWT_SECRET, { expiresIn: "7d" });
}

export function verifyToken(token) {
  try { return jwt.verify(token, process.env.JWT_SECRET); } catch { return null; }
}

export async function getUserFromRequest(req) {
  const token = req.cookies?.token || req.headers.get("cookie")?.match(/token=([^;]+)/)?.[1];
  if (!token) return null;
  const decoded = verifyToken(token);
  if (!decoded) return null;
  return await prisma.user.findUnique({ where: { id: decoded.id } });
}

lib/responses.ts
export function ok(data={}, message='') {
  return new Response(JSON.stringify({ status:'success', message, data }), { status: 200, headers: {'Content-Type':'application/json'} });
}
export function bad(message='', code=400) {
  return new Response(JSON.stringify({ status:'error', message }), { status: code, headers: {'Content-Type':'application/json'} });
}

lib/helpers.ts (Ù…Ù‡Ù…)

ØªØ¶Ù…:

calculateDeposit(price, bookingDateTimeUTC) â†’ Ø¥Ø°Ø§ Ø§Ù„ÙØ±Ù‚ >=24 Ø³Ø§Ø¹Ø© ØªØ±Ø¬Ø¹ price ÙˆØ¥Ù„Ø§ 0.

combineDateAndTime(dateStr, timeStr) â†’ Date UTC.

isSlotAvailable(prisma, fieldId, dateUTC, slotId) â†’ Ø¯Ø§Ø®Ù„ transaction: ØªØ­Ù‚Ù‚ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Booking Ù…Ø¹ status CONFIRMED/PENDING.

createBookingTransaction(...) â†’ encapsulate transaction.

(Ø³Ø£ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø¹Ù†Ø¯ Ø·Ù„Ø¨ ØªÙ†ÙÙŠØ° route Ù…Ø¹ÙŠÙ†.)

5 â€” Middleware (Ù…Ù„Ù middleware.ts)
import { NextResponse } from "next/server";
import { verifyToken } from "./lib/auth";

export async function middleware(req) {
  const { pathname } = req.nextUrl;
  // protect APIs that need auth
  if (pathname.startsWith("/api/") && (pathname.startsWith("/api/bookings") || pathname.startsWith("/api/fields/create") || pathname.startsWith("/api/schedule"))) {
    const token = req.cookies.get("token")?.value;
    if (!token) return NextResponse.json({ status:'error', message:'Unauthorized' }, { status: 401 });
    const decoded = verifyToken(token);
    if (!decoded) return NextResponse.json({ status:'error', message:'Invalid token' }, { status: 401 });
    // attach role? can't mutate req; routes should re-verify user.
  }
  // protect dashboards - redirect to login if no token
  if (pathname.startsWith("/dashboard")) {
    const token = req.cookies.get("token")?.value;
    if (!token) return NextResponse.redirect(new URL("/(auth)/login", req.url));
  }
  return NextResponse.next();
}


Ù…Ù„Ø§Ø­Ø¸Ø©: Route Handlers ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹ÙŠØ¯ÙˆØ§ ÙØ­Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø£Ù† middleware Ù„Ø§ ØªØ¹Ø·ÙŠ Ø§Ù„Ù€ user object Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ handler ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.

6 â€” API Route Handlers â€” Ù…ÙˆØ¬Ø² Ø§Ù„Ø¹Ù‚ÙˆØ¯ (Contracts)

ÙƒÙ„ route ÙŠØ±Ø¬Ø¹ JSON Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù€ lib/responses.ok Ø£Ùˆ .bad.

POST /api/auth/register

Body: { name, email, password }

Action: validate, hash password (bcrypt), create user(role=USER), sign token, set cookie token (HttpOnly), return user (id, name, role).

Errors: 409 email exists, 400 invalid.

POST /api/auth/login

Body: { email, password }

Action: verify, sign token, set cookie, return user + redirect path (based on role).

Errors: 401 invalid.

GET /api/fields/list?type=&areaId=&q=&page=&limit=

Return: paginated fields + area info + owner basic info.

GET /api/fields/details?id=&date=YYYY-MM-DD

Return: field details + availableSlots: [{ slotId, label, status }] for given date.

How: read FieldSchedule for weekday, for each slot check Booking unique on that date.

POST /api/fields/create (OWNER|ADMIN)

Body: field data.

Action: create field, call schedule/generate optional.

POST /api/schedule/generate

Body: { fieldId }

Action: read field.openHour/closeHour/activeDays => create TimeSlot upserts and FieldSchedule entries.

POST /api/bookings/create

Body: { fieldId, date: 'YYYY-MM-DD', slotId }

Steps:

compute slot start datetime UTC

diffHours = (start - now)/3600

begin prisma.$transaction:

check if Booking exists same field/date/slot -> return conflict

if diffHours < 24:

create Booking status=CONFIRMED, amount=field.pricePerHour (or 0 deposit per your rule)

return booking
else:

create Booking status=PENDING, amount=field.pricePerHour (deposit = pricePerHour)

create Payment record status=PENDING amount=deposit

create Paymob payment session (server-side call) -> get payUrl or iframe token

return { bookingId, payUrl }

Concurrency safe by unique constraint and transaction.

POST /api/bookings/cancel

Body: { bookingId, reason }

Check rights: userOwns || ownerOfField || employeeAssigned || admin

Update booking.status=CANCELLED, set cancelledBy, cancelledAt, cancelReason.

If payment SUCCESS -> flag refund_needed (manual flow).

GET /api/bookings/list?role=player|owner|employee&dateFrom&dateTo

Return bookings accordingly with includes: field, slot, payment.

POST /api/payments/webhook (Paymob)

Validate provider signature (if any)

Find Payment by providerTxId or bookingId

If success -> update Payment.status = SUCCESS and Booking.status = CONFIRMED (link paymentId)

If failed -> Payment.status = FAILED ; Booking.status = FAILED or remain PENDING

7 â€” Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª (Frontend) â€” Ù…Ù„ÙØ§Øª ÙˆØµÙ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©
/app/page.tsx (Landing)

header + 4 cards: Soccer, Padel, Add Field (link to Google Form), My Bookings

Each card routes to /fields?type=SOCCER or /fields?type=PADEL

/app/(auth)/login/page.tsx

Form (email,password) -> POST /api/auth/login

On success: redirect to /dashboard/{role}

/app/fields/page.tsx

Fetch /api/fields/list with filters (area, q)

Show FieldCard for each

Pagination controls

/app/fields/[id]/page.tsx

Fetch /api/fields/details?id=...&date=YYYY-MM-DD

Show details, images, price, features

Show booking UI: date picker -> list of BookingSlot components

On click BookingSlot -> call /api/bookings/create

Handle pay redirect if needed, else show confirmation

/app/my-bookings/page.tsx

Fetch /api/bookings/list?role=player

Show table with statuses and cancel button

Dashboards

/app/dashboard/player -> my bookings + quick actions

/app/dashboard/owner -> stats: weekly/monthly revenue, bookings per day, top fields, cancellations list

/app/dashboard/employee -> list of assigned fields and booking controls (book/cancel) for each

/app/dashboard/admin -> manage users, fields, set roles

8 â€” Ù…ÙƒÙˆÙ†Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ© (component contracts)
FieldCard.tsx

Props:

{ id, name, image, pricePerHour, location, areaName, onView }


Behavior:

display info + button "View" navigates to /fields/[id]

BookingSlot.tsx

Props:

{ slotId, label, status, disabled, onBook }


Statuses:

available (clickable)

booked (disabled)

pending (payment in progress)

cancelled (show reason)
Behavior:

onBook -> call handler passed from page

9 â€” Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ£Ù…Ø§Ù† Ø£Ø³Ø§Ø³ÙŠØ© (Ù„Ø§ ØªØªØ®Ù„Ù‰ Ø¹Ù†Ù‡Ø§)

Passwords: hash with bcrypt (saltRounds 12).

JWT: HttpOnly cookie token, SameSite=Lax, Secure=true ÙÙŠ prod.

Validate ÙƒÙ„ Ø¥Ø¯Ø®Ø§Ù„ (email format, date format, slotId exists).

Use transactions Ù„create booking + create payment.

Rate-limit /api/bookings/create per IP/user (to avoid spam).

Webhook security: verify signature or secret.

Escape/validate fields Ù…Ù† XSS Ø¹Ù†Ø¯ Ø¹Ø±Ø¶ Ø£ÙŠ user input Ù…Ø«Ù„ field.description.

10 â€” Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¯ÙØ¹ Ù…Ø¹ Paymob (Ù…Ø¨Ø³Ø·)

Client ÙŠØ·Ù„Ø¨ Ø­Ø¬Ø² ÙŠØ­ØªØ§Ø¬ Ø¯ÙØ¹ â†’ Server ÙŠÙ†Ø´Ø¦ Booking (PENDING) ÙˆPayment (PENDING).

Server ÙŠÙ†Ø§Ø¯ÙŠ Paymob API Ù„Ø¥Ù†Ø´Ø§Ø¡ order Ùˆpayment_key ÙˆÙŠØ¹ÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯ÙØ¹ (payUrl) Ø£Ùˆ iframe token.

Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠÙƒÙ…Ù„ Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Paymob.

Paymob ÙŠØ¹ÙŠØ¯ redirect Ø£Ùˆ ÙŠØ±Ø³Ù„ webhook Ø¥Ù„Ù‰ /api/payments/webhook.

Webhook ÙŠØ­Ù‚Ù‚ providerTxId, amountØŒ ÙˆÙŠØ­Ø¯Ù‘Ø« Payment.status Ùˆ Booking.status.

Ø­Ø§ÙØ¸Ø©: Ù„Ø§ ØªØ¹ØªØ¨Ø± redirect ÙƒØ¯Ù„ÙŠÙ„ Ù†Ù‡Ø§Ø¦ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙØ¹ â€” ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± webhook Ø£Ùˆ Ø§Ø³ØªØ¹Ù„Ø§Ù… Paymob Ø¹Ù† Ø§Ù„Ø­Ø§Ù„Ø©.

11 â€” seed script (Ø§Ù‚ØªØ±Ø§Ø­ Ø³Ø±ÙŠØ¹)

prisma/seed.ts ÙŠÙ‚ÙˆÙ… Ø¨:

Ø¥Ø¯Ø®Ø§Ù„ Areas

Ø¥Ø¯Ø®Ø§Ù„ TimeSlots Ù…Ù† 06:00 Ø¥Ù„Ù‰ 23:00

Ø¥Ù†Ø´Ø§Ø¡ admin, owner, employee, sample users

Ø¥Ù†Ø´Ø§Ø¡ 4â€“6 Fields ÙˆØ±Ø¨Ø·Ù‡Ù… Ø¨Ø§Ù„owner

assign employee.fieldIds Ù„Ø¹Ø¯Ø© Ù…Ù„Ø§Ø¹Ø¨

Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ù„Ù„ØªØ¬Ø±Ø¨Ø©

(Ø£ÙƒØªØ¨ Ù„Ùƒ Ø³ÙƒØ±ÙŠØ¨Øª Ø¬Ø§Ù‡Ø² Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª.)

12 â€” Ø£ÙˆØ§Ù…Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ (local dev)
# ØªØ«Ø¨ÙŠØª
npm install

# Prisma: generate + migrate
npx prisma generate
npx prisma migrate dev --name init

# Seed (Ø¨Ø¹Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø©)
npm run prisma:seed   # script ÙÙŠ package.json

# ØªØ´ØºÙŠÙ„ dev
npm run dev


package.json scripts Ù…Ù‚ØªØ±Ø­:

{
  "dev": "next dev",
  "build": "next build",
  "start": "next start",
  "prisma:generate": "prisma generate",
  "prisma:migrate": "prisma migrate dev --name init",
  "prisma:seed": "ts-node prisma/seed.ts"
}

13 â€” Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹ Ù„Ù„ØªØ£ÙƒØ¯ (checklist)

Ø¨Ø¹Ø¯ Ø¥Ø¹Ø¯Ø§Ø¯ DB Ùˆ ØªØ´ØºÙŠÙ„:

 Register user -> cookie token set

 Create owner + field -> schedule generated

 Fetch field details for a date -> available slots accurate

 Create booking <24h -> CONFIRMED without payment

 Create booking >=24h -> PENDING + payment created

 Complete payment via Paymob -> webhook updates Booking to CONFIRMED

 Employee can book/cancel only their fields

 Admin can change user role

 Unique constraint prevents double-booking (test concurrent calls)

14 â€” Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ© Ù…Ù‚ØªØ±Ø­Ø© (minimal)

Unit: helpers.calculateDeposit

Integration: create booking happy path (no pay), create booking pay path

Concurrency: simulate two parallel create booking requests for same slot -> one fails with conflict

15 â€” Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®ØªØ§Ù…ÙŠØ© ÙˆÙ†ØµØ§Ø¦Ø­ ØªÙ†ÙÙŠØ°ÙŠØ©

Ø§ØªØ¨Ø¹ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø­Ø±ÙÙŠØ§Ù‹: ÙƒÙ„ API ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ¨Ø¹ Request/Response Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù‡Ù†Ø§.

Ù„Ø§ ØªÙ‚Ù… Ø¨ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù€ unique constraint ÙÙŠ Booking Ù…Ø§ Ù„Ù… ØªÙÙ‡Ù… ØªØ¨Ø¹Ø§Øª concurrency.

Ø§Ø³ØªØ®Ø¯Ù… UTC Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¯Ø§Ø®Ù„ DB. Ø­ÙˆÙ‘Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¹Ø±Ø¶.

Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ù€ seed Ù„ØªØ¬Ø±Ø¨Ø© Ø³Ø±ÙŠØ¹Ø©ØŒ ÙˆÙ„Ø§ ØªØ¹Ù…Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠØ© ÙÙŠ DB Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ·ÙˆÙŠØ± Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¶Ø§Ø±Ø¨.
Ù…Ù„ÙØ§Øª ÙˆÙ…Ø¬Ù„Ø¯Ø§Øª Ù…ÙØµÙ‘Ù„Ø©

Ø³Ø£Ø¹Ø±Ø¶ ÙƒÙ„ Ù…Ù„Ù/Ù…Ø¬Ù„Ø¯ ÙÙŠ ØªØ±ØªÙŠØ¨ Ø¹Ù…Ù„ÙŠ: ÙˆØ¸ÙŠÙØªÙ‡ØŒ ÙˆØ¸Ø§Ø¦Ù/exports Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (request/response)ØŒ Ø£Ù…Ø«Ù„Ø© Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª PrismaØŒ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©ØŒ ÙˆØªØ­Ø³ÙŠÙ†Ø§Øª Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©.

1. /prisma/schema.prisma

Ø§Ù„Ù‡Ø¯Ù: ØªØ¹Ø±ÙŠÙ Ù…Ø®Ø·Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù‡Ùˆ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„ÙˆØ­ÙŠØ¯ Ù„Ù„Ø­Ù‚ÙŠÙ‚Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ù€ DB.

Ù…Ø­ØªÙˆÙ‰ Ø£Ø³Ø§Ø³ÙŠ: Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„: User, Area, Field, TimeSlot, FieldSchedule, Booking, Payment, Employee Ù…Ø¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ ÙˆØ§Ù„Ù€ enums: Role, FieldType, BookingStatus, PaymentStatus.

Ù†Ù‚Ø§Ø· Ù…Ù‡Ù…Ø©:

Ø§Ø³ØªØ®Ø¯Ù… String @id @default(uuid()) Ù„ÙƒÙ„ id.

Field.activeDays Int[] ÙˆEmployee.fieldIds String[] Ù„Ø£Ù†Ùƒ Ø¹Ù„Ù‰ PostgreSQL.

@@unique([fieldId, date, slotId]) ÙÙŠ Booking Ù„Ù…Ù†Ø¹ Ø§Ù„Ø§Ø²Ø¯ÙˆØ§Ø¬.

ØªØ£ÙƒØ¯ Ø£Ù† providerTxId ÙÙŠ Payment Ù„Ù‡ index Ø¥Ù† ÙƒÙ†Ø§ Ù†Ø¨Ø­Ø« Ø¨Ù‡.

Ø®Ø·ÙˆØ§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„:

npx prisma generate

npx prisma migrate dev --name init (Ø£Ùˆ deploy Ø­Ø³Ø¨ Ø§Ù„Ø¨ÙŠØ¦Ø©)

2. /lib/prisma.ts

Ø§Ù„Ù‡Ø¯Ù: ØªÙˆÙÙŠØ± ÙƒØ§Ø¦Ù† Prisma Client Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙƒÙ„Ù‡.

ØªØµØ¯ÙŠØ±:

import { PrismaClient } from '@prisma/client';
const prisma = global.prisma || new PrismaClient();
if (process.env.NODE_ENV !== 'production') global.prisma = prisma;
export default prisma;


Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ø³ØªØ¹Ù…Ø§Ù„ caching ÙÙŠ dev Ù„ØªØ¬Ù†Ù‘Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ø§ØªØµØ§Ù„Ø§Øª Ù…ØªØ¹Ø¯Ù‘Ø¯Ø©.

3. /lib/auth.ts

Ø§Ù„Ù‡Ø¯Ù: Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† JWTØŒ Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†.

ÙˆØ¸Ø§Ø¦Ù Ù…Ù‡Ù…Ø©:

signToken(user: { id, role }) => string â€” ÙŠØ³ØªØ®Ø¯Ù… process.env.JWT_SECRET.

verifyToken(token) => decoded | null â€” try/catch.

getUserFromToken(token) => prisma.user.findUnique({ where: { id } }) â€” Ù„Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØ§Ù…Ù„Ø©.

Ù…Ù…Ø§Ø±Ø³Ø§Øª Ø£Ù…Ø§Ù†:

Ø§Ø³ØªØ®Ø¯Ù… HttpOnly cookie Ù…Ø¹ SameSite=Lax ÙˆSecure Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ§Ø¬.

Ù„Ø§ ØªØ¶Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© ÙÙŠ Ø§Ù„ØªÙˆÙƒÙ† Ø³ÙˆÙ‰ id Ùˆrole.

4. /lib/responses.ts

Ø§Ù„Ù‡Ø¯Ù: ÙˆØ§Ø¬Ù‡Ø© Ù…ÙˆØ­Ù‘Ø¯Ø© Ù„Ù„Ù€ responses.

ØªØµØ¯ÙŠØ±:

export function success(message, data = {}) {
  return NextResponse.json({ status: 'success', message, data });
}
export function error(message, code = 400) {
  return NextResponse.json({ status: 'error', message }, { status: code });
}


Ø§Ø³ØªØ¹Ù…Ø§Ù„: ÙƒÙ„ route ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ³ØªØ¯Ø¹ÙŠ success() Ø£Ùˆ error().

5. /lib/helpers.ts

Ø§Ù„Ù‡Ø¯Ù: Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù…ØªÙƒØ±Ø±Ø©.

Ø¯ÙˆØ§Ù„ Ù…Ù‚ØªØ±Ø­Ø©:

formatDateUTC(date: Date) â†’ string

parseDateToUTC(dateStr) â†’ Date

calculateDeposit(pricePerHour, bookingDate) â†’ number (Ø·Ø¨Ù‚ Ù‚Ø§Ø¹Ø¯Ø© 24 Ø³Ø§Ø¹Ø©)

isSlotAvailable(fieldId, dateUTC, slotId) â†’ boolean (ØªÙØ­Øµ Booking Ù…Ø¹ transaction)

getSlotStartDatetime(dateUTC, slot) â†’ DateTime for diff calc

Ù…Ø«Ø§Ù„ isSlotAvailable (ØªÙ‚Ø±ÙŠØ¨ÙŠ):

async function isSlotAvailable(fieldId, date, slotId) {
  const existing = await prisma.booking.findFirst({
    where: { fieldId, date, slotId, status: { in: ['CONFIRMED','PENDING'] } }
  });
  return !existing;
}

6. /middleware.ts

Ø§Ù„Ù‡Ø¯Ù: Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù€ routes (app routes + api routes Ø¥Ù† ÙˆÙØ¬Ø¯Øª) ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ role.

Ø³Ù„ÙˆÙƒ Ù…Ù‚ØªØ±Ø­:

ÙŠÙ‚Ø±Ø£ cookie token.

verifyToken.

ÙŠØ±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø§Øª /dashboard/* Ø¥Ø°Ø§ Ù„Ù… ÙŠÙ…Ù„Ùƒ role Ø§Ù„Ù…Ù†Ø§Ø³Ø¨.

Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ /auth/login ÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… Ø§Ù„ØªØ­Ù‚Ù‚.

Ù†Ù‚Ø·Ø© Ù…Ù‡Ù…Ø©: Next.js App Router ÙŠØ³Ù…Ø­ Ø¨Ù…Ù„Ù middleware Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¬Ø°Ø±. ÙÙŠ Ø§Ù„Ù€ API routes Ù…Ù† Ø§Ù„Ø£ÙØ¶Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ route Ø£ÙŠØ¶Ø§Ù‹ Ù„Ø£Ù† Ø§Ù„Ù€ middleware Ù‚Ø¯ Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¨Ø¹Ø¶ endpoints (webhook...).

7. /app/layout.tsx Ùˆ /app/page.tsx

layout.tsx

ÙŠØ­ØªÙˆÙŠ Header (Navbar) Ùˆ Footer.

ÙŠØ¶Ù… Provider Ù„Ù„Ù€ Auth/context Ø¥Ø°Ø§ Ø§Ø­ØªØ¬Ù†Ø§.

page.tsx (Landing)

ØµÙØ­Ø© Ø¨Ø³ÙŠØ·Ø© ØªØ±Ø¨Ø· Ø§Ù„Ø£Ø±Ø¨Ø¹ Ø®Ø§Ù†Ø§Øª (Soccer, Padel, Add field link, My Bookings).

8. /app/(auth)/login/page.tsx Ùˆ register/page.tsx

ÙˆØ¸ÙŠÙØ©:

Forms Ù„Ù„Ù€ login/register (email, password, name).

ØªØ³ØªØ¯Ø¹ÙŠ /api/auth/login Ùˆ /api/auth/register.

Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­ ØªØ­ÙØ¸ cookie Ù…Ù† Ø§Ù„Ù€ response (server-side) Ø£Ùˆ ØªØ¹ØªÙ…Ø¯ redirect Ù…Ù† Ø§Ù„Ù€ API Ø§Ù„Ø°ÙŠ ÙŠØ¶Ø¹ cookie.

ØªÙˆØ§ÙÙ‚: ÙŠØ¬Ø¨ Ø£Ù† Ø§Ù„Ù€ API ÙŠØ¶Ø¹ Set-Cookie: token=<jwt>; HttpOnly; Path=/; Max-Age=....

9. /app/dashboard/*/page.tsx (player/owner/employee/admin)

ÙƒÙ„ ØµÙØ­Ø© dashboard:

Fetch Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¯ÙˆØ± Ù…Ù† endpoints Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© (Ù…Ø«Ø§Ù„: owner ÙŠØ¬Ù„Ø¨ /api/bookings/list?ownerId=me).

Layout Ù…ÙˆØ­Ø¯: Sidebar + Main content.

Minimal components: Summary cards, recent bookings table, actions buttons.

ÙˆØ§Ø¬Ù‡Ø© API Ù…Ù‚ØªØ±Ø­Ø© Ù„ÙƒÙ„ Dashboard:

Player â†’ /api/bookings/list?role=player (returns user's bookings)

Owner â†’ /api/bookings/list?role=owner (owner's fields' bookings + revenues)

Employee â†’ /api/bookings/list?role=employee (bookings for employee.fieldIds)

Admin â†’ /api/admin/stats (manage users & fields)

10. /pages vs /app Ù…Ù„Ø§Ø­Ø¸Ø©

Ø¨Ù…Ø§ Ø£Ù†Ùƒ ØªØ³ØªØ®Ø¯Ù… App Router ÙÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª ÙÙŠ /app. Ø§Ù„Ù€ API routes ÙÙŠ /app/api Ø£Ùˆ /api ØªÙ‚Ù†ÙŠÙ‹Ø§ ÙƒÙ„Ø§Ù‡Ù…Ø§ Ù…Ù…ÙƒÙ†ØŒ Ù„ÙƒÙ† Ø¹Ø§Ø¯Ø© Ù†Ø³ØªØ®Ø¯Ù… /app/api Ù…Ø¹ Route Handlers (route.js).

11. /app/api/auth/register/route.ts Ùˆ /login/route.ts

Register

Validate input.

Hash password (bcrypt).

Create user with role USER.

Sign JWT and Set-Cookie.

Return success.

Login

Find user by email.

Compare password.

Sign JWT, set cookie, return role + redirect url in data (optional).

Request/Response:

Request: { name, email, password }

Response success: { status:'success', message:'', data: { user: { id, name, email, role }, redirect: '/dashboard/player' }}

Ø£Ø®Ø·Ø§Ø¡ Ù…ØªÙˆÙ‚Ø¹Ø©:

Email already used -> 409 Conflict.

Weak password -> 400.

12. /app/api/fields/list/route.ts

Feature:

Query params: ?type=soccer&areaId=...&q=...&page=&limit=

Return paginated list with availableSlots for next N days or count.

Prisma Query (ØªÙ‚Ø±ÙŠØ¨ÙŠ):

const fields = await prisma.field.findMany({
  where: { type: typeFilter, areaId },
  include: { area: true, owner: { select: { id, name } } },
  take: limit, skip: (page-1)*limit
});


Note: To show availability for a specific day, call GET /api/fields/:id/details?date=YYYY-MM-DD which will:

read FieldSchedule for the field and weekday

for each slotId get if a Booking exists on that date

13. /app/api/fields/create/route.ts & /update/route.ts

Create

Auth: OWNER or ADMIN.

Body: { name, type, pricePerHour, areaId, openHour, closeHour, activeDays: [0..6], phone, description }

Creates Field and optionally calls schedule/generate to create FieldSchedule entries.

Update

Auth: OWNER for own field or ADMIN.

Updatable fields: price, hours, images, area.

If hours change, may need to regenerate schedules (careful with existing bookings).

Security

Validate ownerId matches token user id for non-admin.

14. /app/api/schedule/generate/route.ts

Goal: ØªÙˆÙ„ÙŠØ¯ FieldSchedule Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø¨ÙŠÙ† openHour Ùˆ closeHour ÙˆØ±Ø¨Ø·Ù‡Ø§ Ø¨Ù€ TimeSlot Ø¹Ø¨Ø± upsert.

Body: { fieldId, startHour, endHour, slotDuration = 1 } Ø£Ùˆ Ø¨Ø¨Ø³Ø§Ø·Ø© ÙŠØ³ØªØ®Ø¯Ù… Field.openHour/closeHour.

Pseudo Implementation:

loop hours -> create or upsert TimeSlot (label unique) -> create FieldSchedule if not exists (upsert).

return created slots.

Edge cases: Ù…Ù„Ø§Ø¹Ø¨ Ù…ÙØªÙˆØ­Ø© Ù„Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„ (Ù…Ø«Ø§Ù„ 22:00â€“02:00) ØªØ­ØªØ§Ø¬ Ù…Ù†Ø·Ù‚ ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¯ÙˆØ±Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ® (Ù†Ø­ÙˆÙ„ closeHour < openHour => Ø¹Ø¨ÙˆØ± Ù„Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ).

15. /app/api/bookings/create/route.ts

Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:

Input: { fieldId, date: 'YYYY-MM-DD', slotId } Ø£Ùˆ slotLabel.

Compute startDateTimeUTC = combine(date, timeSlot.start).

diffHours = (startDateTimeUTC - nowUTC) / 3600.

If diffHours < 24 â†’ deposit = 0, create Booking with status CONFIRMED (or create confirmed payment=none).
Else â†’ deposit = field.pricePerHour (Ø£Ùˆ Ù†Ø³Ø¨Ø©) â†’ create Booking with status PENDING and create Payment record PENDING â†’ initiate Paymob auth and return paymentRedirectUrl to frontend.

Use prisma.$transaction to:

check Booking unique constraint

create Booking (or create+payment)

Return success with booking details or payment redirect url.

Concurrency safety:

Wrap availability check + create booking in transaction.

Unique constraint on booking(fieldId,date,slotId) ensures atomic safety; catch unique violation and return error.

Responses:

If immediate confirmed: { status:'success', message:'confirmed', data: { booking } }

If needs payment: { status:'success', message:'pending_payment', data: { bookingId, payUrl } }

16. /app/api/bookings/cancel/route.ts

Inputs: { bookingId, reason? } and identify caller via token.

Checks:

Only the owner of booking (user), owner (if owns field), employee (if assigned to that field), or admin can cancel.

Update Booking: status = CANCELLED, set cancelReason, cancelledBy, cancelledAt.

If payment was SUCCESS: process refund flow (not in MVP) or mark as refunded manually.

Return: updated booking.

17. /app/api/bookings/list/route.ts

Behavior:

Accepts query params: ?role=player|owner|employee&dateFrom&dateTo

For player: returns where: { userId: me }.

For owner: returns bookings where field.ownerId = me.

For employee: returns bookings where fieldId IN employee.fieldIds.

Include: field, slot, payment relations.

18. /app/api/payments/webhook/route.ts

Purpose: Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ callback/webhook Ù…Ù† Paymob Ø¹Ù†Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹.

Critical Steps:

Validate provider signature (if Paymob ÙŠØ¯Ø¹Ù…).

Find Payment by providerTxId (or by bookingId stored in callback).

Verify amount matches.

Update Payment.status = SUCCESS/FAILED.

If success â†’ update Booking status = CONFIRMED and link paymentId.

Wrap in transaction.

Security note: Webhook URL ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø³Ø±ÙŠ ÙˆÙ…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø²ÙˆØ¯ØŒ ÙƒÙ…Ø§ ØªØ­Ù‚Ù‚ Ù…Ù† IP whitelist Ø¥Ù† Ø£Ù…ÙƒÙ†.

19. /components/* (Navbar, Sidebar, FieldCard, BookingSlot, UI)

Ù‚ÙˆØ§Ø¹Ø¯ Ø¹Ø§Ù…Ø©:

ÙƒÙ„ component Ø¨Ø³ÙŠØ· ÙˆÙˆØ¸ÙŠÙÙŠ.

FieldCard ÙŠØ³ØªÙ„Ù…: { id, name, image, pricePerHour, area, features } ÙˆÙŠØ¹Ø±Ø¶ Ø²Ø± "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†" ÙŠÙˆØ¬Ù‘Ù‡ Ù„Ù€ /fields/[id].

BookingSlot ÙŠØ³ØªÙ„Ù…: { slotId, label, status, onClick } ÙˆÙŠØ¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø£Ù„ÙˆØ§Ù†/Ø­Ø§Ù„Ø© Ø²Ø±.

ÙƒÙ„ UI components ÙŠØ¬Ø¨ Ø£Ù† ØªØ³ØªØ®Ø¯Ù… prop-types Ø£Ùˆ TypeScript interfaces ÙˆØ§Ø¶Ø­Ø©.

20. /components/field/BookingSlot.tsx ØªÙØ§ØµÙŠÙ„

Props:

slotId: string, label: string, status: 'available'|'booked'|'cancelled'|'failed', onBook(slotId).

Behavior:

Ø¥Ø°Ø§ available â†’ Ø²Ø± Book ÙŠÙ‚ÙˆÙ… Ø¨ØµÙ†Ø¹ request Ø¥Ù„Ù‰ /api/bookings/create.

Ø¥Ø¸Ù‡Ø§Ø± feedback loading / success / error.

Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø­Ø§Ù„Ø© double-click: ØªØ¹Ø·Ù‘Ù„ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨.

21. /context/AuthContext.tsx Ùˆ BookingContext.tsx

AuthContext:

ÙŠØ®Ø²Ù† user, loading, login, logout.

login() ÙŠØ³ØªØ¯Ø¹ÙŠ /api/auth/login ÙˆÙŠØ®Ø²Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ state Ø¨Ø¹Ø¯ redirect.

BookingContext (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):

ÙŠØ­ÙØ¸ Ø¢Ø®Ø± Ø­Ø¬Ø² Ù‚Ø§Ù… Ø¨Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙˆØ±Ø§Ù‹ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø¬Ø².

ÙŠÙˆÙØ± Ø¯Ø§Ù„Ø© refreshBookings() ØªØ¤Ø¯ÙŠ fetch Ø¥Ù„Ù‰ /api/bookings/list.

22. /seed/seed.ts

Ù…Ø­ØªÙˆÙ‰:

Create Areas (3 names).

Create TimeSlots: Ù…Ù† 06:00 Ø¥Ù„Ù‰ 23:00 â€” ÙƒÙ„ Ø³Ø§Ø¹Ø©.

Create test Users: admin, ownerA, ownerB, employeeA, player1, player2.

Create Fields: 2â€“3 Ù…Ù„Ø§Ø¹Ø¨ Ù„ÙƒÙ„ owner Ù…Ø¹ open/close/activeDays.

Create Employee entries with fieldIds arrays.

Create sample Bookings (some confirmed, some cancelled) for test.

ØªØ´ØºÙŠÙ„:

ts-node prisma/seed.ts Ø£Ùˆ Ø³ÙƒØ±Ø¨Øª ÙÙŠ package.json: prisma:seed.

23. package.json (Ù†Ù‚Ø·Ø© Ù…Ù‡Ù…Ø©)

scripts Ù…Ù‚ØªØ±Ø­Ø©:

{
  "dev": "next dev",
  "build": "next build",
  "start": "next start",
  "prisma:generate": "prisma generate",
  "prisma:migrate": "prisma migrate dev",
  "prisma:seed": "ts-node prisma/seed.ts"
}

24. Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© (env)

Ù…Ø·Ù„ÙˆØ¨ (Ù…Ø«Ø§Ù„):

DATABASE_URL=postgresql://user:pass@host:5432/dbname
JWT_SECRET=your_super_secret
NEXT_PUBLIC_API_BASE_URL=https://your.domain.com
PAYMOB_API_KEY=...
PAYMOB_IFRAME_ID=...
PAYMOB_INTEGRATION_ID=...
PAYMOB_CALLBACK_URL=https://your.domain.com/api/payments/webhook


Ù†ØµÙŠØ­Ø©: Ù„Ø§ ØªØ¹Ø±Ø¶ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© â€” Ø§Ø³ØªØ®Ø¯Ù… Ù…ØªØºÙŠØ±Ø§Øª Ø¨ÙŠØ¦Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙ‚Ø·.






ğŸ“‹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹
ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©
ØªÙ… ØªØ·ÙˆÙŠØ± Ù†Ø¸Ø§Ù… Ø­Ø¬Ø² Ù…Ù„Ø§Ø¹Ø¨ (Soccer & Padel) Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Next.js 14 (App Router) Ù…Ø¹ TypeScriptØŒ Tailwind CSSØŒ PrismaØŒ PostgreSQLØŒ ÙˆJWT Authentication. Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ù†ØªØ§Ø¬ Ù…Ø¹ ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ ÙˆÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø±Ø¨ÙŠØ©.

ğŸ—ï¸ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù…ÙƒØªÙ…Ù„
text
booking-system/
â”œâ”€â”€ ğŸ“ app/                          # â³ Ø¨Ø§Ù‚ÙŠ Ù„Ù„ØªÙ†ÙÙŠØ°
â”‚   â”œâ”€â”€ (auth)/                     # ØµÙØ­Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
â”‚   â”œâ”€â”€ api/                        # API Routes
â”‚   â”œâ”€â”€ dashboard/                  # Ù„ÙˆØ­Ø§Øª Ø§Ù„ØªØ­ÙƒÙ…
â”‚   â”œâ”€â”€ fields/                     # ØµÙØ­Ø§Øª Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨
â”‚   â”œâ”€â”€ my-bookings/               # Ø­Ø¬ÙˆØ²Ø§ØªÙŠ
â”‚   â”œâ”€â”€ globals.css                # â³
â”‚   â”œâ”€â”€ layout.tsx                 # â³
â”‚   â””â”€â”€ page.tsx                   # â³
â”‚
â”œâ”€â”€ ğŸ“ components/                  # âœ… Ù…ÙƒØªÙ…Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
â”‚   â”œâ”€â”€ ğŸ“ layout/                  # Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ØªØ®Ø·ÙŠØ·
â”‚   â”‚   â”œâ”€â”€ Header.tsx             # Ù‡ÙŠØ¯Ø± Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Auth
â”‚   â”‚   â””â”€â”€ Footer.tsx             # ÙÙˆØªØ± Ù…ØªØ·ÙˆØ±
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ ui/                      # Ù…ÙƒÙˆÙ†Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù…
â”‚   â”‚   â”œâ”€â”€ Button.tsx             # Ø£Ø²Ø±Ø§Ø± Ù…Ø¹ 6 Ø£Ù†Ù…Ø§Ø·
â”‚   â”‚   â”œâ”€â”€ Card.tsx               # Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ø¹ sub-components
â”‚   â”‚   â”œâ”€â”€ Input.tsx              # Ø­Ù‚ÙˆÙ„ Ø¥Ø¯Ø®Ø§Ù„ Ù…ØªÙ‚Ø¯Ù…Ø©
â”‚   â”‚   â”œâ”€â”€ LoadingSpinner.tsx     # Ù…Ø¤Ø´Ø± ØªØ­Ù…ÙŠÙ„
â”‚   â”‚   â”œâ”€â”€ Modal.tsx              # Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø©
â”‚   â”‚   â””â”€â”€ Toast.tsx              # Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
â”‚   â”‚
â”‚   â”œâ”€â”€ FieldCard.tsx              # Ø¨Ø·Ø§Ù‚Ø© Ù…Ù„Ø¹Ø¨ Ù…ØªÙƒØ§Ù…Ù„Ø©
â”‚   â””â”€â”€ BookingSlot.tsx            # ÙØªØ­Ø© Ø­Ø¬Ø² Ø°ÙƒÙŠØ©
â”‚
â”œâ”€â”€ ğŸ“ context/                     # âœ… Ù…ÙƒØªÙ…Ù„
â”‚   â””â”€â”€ AuthContext.tsx            # Context Ù…ØµØ§Ø¯Ù‚Ø© Ù…ØªÙƒØ§Ù…Ù„
â”‚
â”œâ”€â”€ ğŸ“ lib/                         # âœ… Ù…ÙƒØªÙ…Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
â”‚   â”œâ”€â”€ auth.ts                    # Ù†Ø¸Ø§Ù… Ù…ØµØ§Ø¯Ù‚Ø© ÙƒØ§Ù…Ù„
â”‚   â”œâ”€â”€ constants.ts               # Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø«ÙˆØ§Ø¨Øª ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„
â”‚   â”œâ”€â”€ env.ts                     # ØªØ­Ù‚Ù‚ Ù…Ù† Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
â”‚   â”œâ”€â”€ errors.ts                  # Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
â”‚   â”œâ”€â”€ helpers.ts                 # Ø£Ø¯ÙˆØ§Øª Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„
â”‚   â”œâ”€â”€ logger.ts                  # Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ù…Ø­ÙÙˆØ¸Ø§Øª
â”‚   â”œâ”€â”€ prisma.ts                  # Ø§ØªØµØ§Ù„ Prisma Ù…Ø¹ middleware
â”‚   â”œâ”€â”€ rateLimit.ts               # Ù†Ø¸Ø§Ù… Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
â”‚   â”œâ”€â”€ responses.ts               # Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª API Ù…ÙˆØ­Ø¯Ø©
â”‚   â””â”€â”€ utils.ts                   # Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø©
â”‚
â”œâ”€â”€ ğŸ“ types/                       # âœ… Ù…ÙƒØªÙ…Ù„
â”‚   â””â”€â”€ index.ts                   # Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ TypeScript
â”‚
â”œâ”€â”€ ğŸ“ utils/                       # âœ… Ù…ÙƒØªÙ…Ù„
â”‚   â””â”€â”€ sendMail.ts                # Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª Ù…Ø¹ Ù‚ÙˆØ§Ù„Ø¨
â”‚
â”œâ”€â”€ middleware.ts                   # âœ… Ø­Ù…Ø§ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø©
â”œâ”€â”€ prisma/schema.prisma           # â³ Ù…Ø®Ø·Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â””â”€â”€ tailwind.config.js             # â³ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Tailwind
âœ… Ù…Ø§ ØªÙ… Ø¥Ù†Ø¬Ø§Ø²Ù‡ Ø¨Ø§Ù„ÙØ¹Ù„
1. ğŸ“¦ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª (Components) - Ù…ÙƒØªÙ…Ù„ 100%
Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ØªØ®Ø·ÙŠØ·:
Header.tsx - Ù‡ÙŠØ¯Ø± Ø°ÙƒÙŠ Ù…Ø¹:

ØªÙƒØ§Ù…Ù„ Ù…Ø¹ AuthContext

Ø¹Ø±Ø¶ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø­Ø³Ø¨ Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

Ù‚Ø§Ø¦Ù…Ø© Ù…ØªÙ†Ù‚Ù„Ø© Ù…ØªØ¬Ø§ÙˆØ¨Ø©

Ø£Ø²Ø±Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„/Ø®Ø±ÙˆØ¬ Ø°ÙƒÙŠØ©

Footer.tsx - ÙÙˆØªØ± Ù…ØªØ·ÙˆØ± Ù…Ø¹:

Ø£Ù‚Ø³Ø§Ù… Ù…ØªØ¹Ø¯Ø¯Ø© (Ø±ÙˆØ§Ø¨Ø·ØŒ Ù…Ù†Ø§Ø·Ù‚ØŒ Ø§ØªØµØ§Ù„)

Ù†Ù…ÙˆØ°Ø¬ Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ù†Ø´Ø±Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠØ©

Ø²Ø± "Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰"

ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ

Ù…ÙƒÙˆÙ†Ø§Øª UI:
Button.tsx - 6 Ø£Ù†Ù…Ø§Ø·ØŒ 5 Ø£Ø­Ø¬Ø§Ù…ØŒ Ø¯Ø¹Ù… Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª

Card.tsx - Ù…Ø¹ sub-components (Header, Title, Content, Footer)

Input.tsx - Ø­Ù‚ÙˆÙ„ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹ validation Ùˆpassword toggle

LoadingSpinner.tsx - 5 Ø£Ø­Ø¬Ø§Ù…ØŒ Ø£ÙˆØ¶Ø§Ø¹ fullscreen

Modal.tsx - Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© scroll lock

Toast.tsx - Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…Ø¹ progress bar

Ù…ÙƒÙˆÙ†Ø§Øª Ø®Ø§ØµØ©:
FieldCard.tsx - Ø¨Ø·Ø§Ù‚Ø© Ù…Ù„Ø¹Ø¨ Ù…Ø¹:

ØµÙˆØ±ØŒ Ø³Ø¹Ø±ØŒ ØªÙ‚ÙŠÙŠÙ…ØŒ Ù…ÙŠØ²Ø§Øª

Ø£Ø²Ø±Ø§Ø± ØªÙØ§ØµÙŠÙ„ ÙˆØ­Ø¬Ø²

Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø©

Ø®ØµÙˆÙ…Ø§Øª ÙˆØ¹Ø±ÙˆØ¶

BookingSlot.tsx - ÙØªØ­Ø© Ø­Ø¬Ø± Ù…Ø¹:

5 Ø­Ø§Ù„Ø§Øª (Ù…ØªØ§Ø­ØŒ Ù…Ø­Ø¬ÙˆØ²ØŒ Ù…Ø¹Ù„Ù‚ØŒ Ù…Ù„ØºÙ‰ØŒ ØºÙŠØ± Ù…ØªØ§Ø­)

Ø³Ø§Ø¹Ø§Øª Ø°Ø±ÙˆØ© ÙˆØ£Ø³Ø¹Ø§Ø± Ù…Ø®ØªÙ„ÙØ©

Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ¯Ø§Ø¦Ø¹

Ø£Ø²Ø±Ø§Ø± Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©

2. ğŸ” Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Core System) - Ù…ÙƒØªÙ…Ù„ 100%
Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Authentication):
typescript
// Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©:
- context/AuthContext.tsx    // React Context
- lib/auth.ts                // Server-side auth
- middleware.ts              // Route protection
Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:

âœ… JWT Ù…Ø²Ø¯ÙˆØ¬ (Access + Refresh tokens)

âœ… HttpOnly cookies Ø¢Ù…Ù†Ø©

âœ… Role-based access control

âœ… Auto token refresh

âœ… Secure password hashing (bcrypt)

âœ… Password reset system

Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:

login(), register(), logout()

verifyToken(), refreshAccessToken()

requireAuth(), getCurrentUser()

setAuthCookies(), clearAuthCookies()

Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Error Handling):
typescript
// Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:
- AppError              // Ø®Ø·Ø£ Ù…Ø®ØµØµ
- ValidationError       // Ø£Ø®Ø·Ø§Ø¡ ØªØ­Ù‚Ù‚
- AuthenticationError   // Ù…ØµØ§Ø¯Ù‚Ø©
- AuthorizationError    // ØµÙ„Ø§Ø­ÙŠØ§Øª
- NotFoundError         // Ù…ÙˆØ±Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯
- ConflictError         // ØªØ¹Ø§Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª
- DatabaseError         // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª
- PaymentError          // Ø¯ÙØ¹
- ExternalApiError      APIs Ø®Ø§Ø±Ø¬ÙŠØ©
Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Rate Limiting):
typescript
// Ù…Ø¹Ø¯Ù„Ø§Øª Ù…Ø³Ø¨Ù‚Ø©:
- globalRateLimit      // 100 Ø·Ù„Ø¨/15 Ø¯Ù‚ÙŠÙ‚Ø©
- authRateLimit        // 10 Ù…Ø­Ø§ÙˆÙ„Ø©/Ø³Ø§Ø¹Ø©
- apiRateLimit         // 60 Ø·Ù„Ø¨/Ø¯Ù‚ÙŠÙ‚Ø©
- userRateLimit        // 50 Ø·Ù„Ø¨/Ø³Ø§Ø¹Ø©
- bookingRateLimit     // 10 Ø­Ø¬Ø²/Ø³Ø§Ø¹Ø©
- paymentRateLimit     // 5 Ø¯ÙØ¹/5 Ø¯Ù‚Ø§Ø¦Ù‚
Ø§Ù„Ù…ØªØ§Ø¬Ø± Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©:

Memory Store (Ù„Ù„ØªØ·ÙˆÙŠØ±)

Redis Store (Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬)

Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Logging):
typescript
// Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª:
- ERROR    // Ø£Ø®Ø·Ø§Ø¡
- WARN     // ØªØ­Ø°ÙŠØ±Ø§Øª
- INFO     // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
- HTTP     // Ø·Ù„Ø¨Ø§Øª HTTP
- DEBUG    // ØªØªØ¨Ø¹
Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:

âœ… Daily rotating files

âœ… Separate error/access logs

âœ… Development console output

âœ… Request/response timing

âœ… Structured logging

Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ¦Ø© (Environment):
typescript
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†:
- DATABASE_URL      // Ø±Ø§Ø¨Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª
- JWT_SECRET        // Ù…ÙØªØ§Ø­ ØªØ´ÙÙŠØ±
- NEXT_PUBLIC_BASE_URL // Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
- PAYMOB_API_KEY    // Ù…ÙØªØ§Ø­ Paymob
- MAIL_USER/PASS    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯
3. ğŸ“„ Ø§Ù„Ø«ÙˆØ§Ø¨Øª ÙˆØ§Ù„Ø£Ù†ÙˆØ§Ø¹ (Constants & Types)
Ø§Ù„Ø«ÙˆØ§Ø¨Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
typescript
// ÙÙŠ lib/constants.ts:
- USER_ROLES        // 5 Ø£Ø¯ÙˆØ§Ø±
- FIELD_TYPES       // Soccer/Padel
- BOOKING_STATUS    // 4 Ø­Ø§Ù„Ø§Øª
- PAYMENT_STATUS    // 5 Ø­Ø§Ù„Ø§Øª
- WEEK_DAYS         // Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
- STATUS_COLORS     // Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø­Ø§Ù„Ø§Øª
Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Ø¬Ù…ÙŠØ¹Ù‡Ø§ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©):
typescript
// 6 ÙØ¦Ø§Øª Ù„Ù„Ø£Ø®Ø·Ø§Ø¡:
- AUTH              // Ù…ØµØ§Ø¯Ù‚Ø©
- BOOKING           // Ø­Ø¬ÙˆØ²Ø§Øª
- PAYMENT           // Ø¯ÙØ¹
- VALIDATION        // ØªØ­Ù‚Ù‚
- FILE              // Ù…Ù„ÙØ§Øª
- GENERAL           // Ø¹Ø§Ù…
Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­:
typescript
// 6 ÙØ¦Ø§Øª Ù„Ù„Ù†Ø¬Ø§Ø­:
- AUTH              // Ù…ØµØ§Ø¯Ù‚Ø©
- BOOKING           // Ø­Ø¬ÙˆØ²Ø§Øª
- PAYMENT           // Ø¯ÙØ¹
- FIELD             // Ù…Ù„Ø§Ø¹Ø¨
- EMPLOYEE          // Ù…ÙˆØ¸ÙÙŠÙ†
- FILE              // Ù…Ù„ÙØ§Øª
Ø£Ù†ÙˆØ§Ø¹ TypeScript:
typescript
// ÙÙŠ types/index.ts:
- All Prisma models
- All API request/response types
- Auth types
- Payment types
- Filter & pagination types
4. ğŸ›¡ï¸ Ø§Ù„Ø­Ù…Ø§ÙŠØ© ÙˆØ§Ù„Ø£Ù…Ø§Ù† (Security)
Middleware Ø§Ù„Ø­Ù…Ø§ÙŠØ©:
typescript
// Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:
- Route protection based on roles
- Public/private path handling
- Security headers (CSP, X-Frame, etc.)
- Rate limiting integration
- Request logging
- Error handling
Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ©:
Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©: /, /login, /register, /fields

Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ©: /dashboard/*, /my-bookings, /api/*

Ø§Ù„ØªØ­Ù‚Ù‚ Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±: Owner, Employee, Admin, User

API Protection: JWT validation per request

Security Headers:
http
Content-Security-Policy: default-src 'self';
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin
5. ğŸ¨ Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Tailwind):
javascript
// Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
primary:    // Ø£Ø²Ø±Ù‚ Ù„Ù„ØªØ£ÙƒÙŠØ¯
danger:     // Ø£Ø­Ø¶Ø± Ù„Ù„Ø£Ø®Ø·Ø§Ø±
success:    // Ø£Ø®Ø¶Ø± Ù„Ù„Ù†Ø¬Ø§Ø­
warning:    // Ø£ØµÙØ± Ù„Ù„ØªØ­Ø°ÙŠØ±Ø§Øª
Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨:
âœ… Mobile-first design

âœ… Breakpoints: sm, md, lg, xl

âœ… Responsive grids

âœ… Adaptive components

Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª:
âœ… Hover effects

âœ… Transitions

âœ… Animations

âœ… Loading states

âœ… Error states

ğŸ”§ Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©
1. Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­Ù‚Ù‚ (Validation):
typescript
isValidEmail(email)          // ØªØ­Ù‚Ù‚ Ø¨Ø±ÙŠØ¯
isValidPhone(phone)          // ØªØ­Ù‚Ù‚ Ù‡Ø§ØªÙ
isValidPassword(password)    // ØªØ­Ù‚Ù‚ Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±
validateBookingData(data)    // ØªØ­Ù‚Ù‚ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø¬Ø²
2. Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ (Formatting):
typescript
formatCurrency(amount)       // ØªÙ†Ø³ÙŠÙ‚ Ø¹Ù…Ù„Ø©
formatDate(date)             // ØªÙ†Ø³ÙŠÙ‚ ØªØ§Ø±ÙŠØ®
formatTime(time)             // ØªÙ†Ø³ÙŠÙ‚ ÙˆÙ‚Øª
truncateText(text, length)   // ØªÙ‚ØµÙŠØ± Ù†Øµ
3. Ø£Ø¯ÙˆØ§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:
typescript
isSlotAvailable()           // ØªØ­Ù‚Ù‚ ØªÙˆÙØ± ÙˆÙ‚Øª
createBookingTransaction()  // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø¬Ø² Ù…Ø¹ transaction
calculateDeposit()          // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ¯ÙŠØ¹Ø©
generateTimeSlots()         // ØªÙˆÙ„ÙŠØ¯ Ø£ÙˆÙ‚Ø§Øª
4. Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:
typescript
sendMail()                          // Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø±ÙŠØ¯
createBookingConfirmationEmail()    // Ù‚Ø§Ù„Ø¨ ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø²
createPasswordResetEmail()          // Ù‚Ø§Ù„Ø¨ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
createWelcomeEmail()                // Ù‚Ø§Ù„Ø¨ ØªØ±Ø­ÙŠØ¨
ğŸš€ Ù…Ø§ ÙŠØ­ØªØ§Ø¬ Ø¥ÙƒÙ…Ø§Ù„Ù‡ ÙÙŠ /app
1. ğŸ“ ØµÙØ­Ø§Øª Ø§Ù„Ø±Ø§ÙˆØª (Pages)
text
app/
â”œâ”€â”€ (auth)/                 # â³ ØµÙØ­Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â””â”€â”€ register/page.tsx
â”‚
â”œâ”€â”€ dashboard/              # â³ Ù„ÙˆØ­Ø§Øª Ø§Ù„ØªØ­ÙƒÙ…
â”‚   â”œâ”€â”€ admin/page.tsx
â”‚   â”œâ”€â”€ employee/page.tsx
â”‚   â”œâ”€â”€ owner/page.tsx
â”‚   â””â”€â”€ player/page.tsx
â”‚
â”œâ”€â”€ fields/                 # â³ ØµÙØ­Ø§Øª Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨
â”‚   â”œâ”€â”€ [id]/page.tsx
â”‚   â””â”€â”€ page.tsx
â”‚
â”œâ”€â”€ my-bookings/           # â³ ØµÙØ­Ø© Ø­Ø¬ÙˆØ²Ø§ØªÙŠ
â”‚   â””â”€â”€ page.tsx
â”‚
â”œâ”€â”€ globals.css            # â³ Ø£Ù†Ù…Ø§Ø· Ø¹Ø§Ù…Ø©
â”œâ”€â”€ layout.tsx             # â³ ØªØ®Ø·ÙŠØ· Ø±Ø¦ÙŠØ³ÙŠ
â””â”€â”€ page.tsx               # â³ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
2. ğŸ“ API Routes
text
app/api/
â”œâ”€â”€ auth/                  # â³ Ù…ØµØ§Ø¯Ù‚Ø©
â”‚   â”œâ”€â”€ login/route.ts
â”‚   â”œâ”€â”€ register/route.ts
â”‚   â”œâ”€â”€ logout/route.ts
â”‚   â”œâ”€â”€ me/route.ts
â”‚   â””â”€â”€ refresh/route.ts
â”‚
â”œâ”€â”€ bookings/              # â³ Ø­Ø¬ÙˆØ²Ø§Øª
â”‚   â”œâ”€â”€ create/route.ts
â”‚   â”œâ”€â”€ list/route.ts
â”‚   â”œâ”€â”€ cancel/route.ts
â”‚   â””â”€â”€ [id]/route.ts
â”‚
â”œâ”€â”€ fields/                # â³ Ù…Ù„Ø§Ø¹Ø¨
â”‚   â”œâ”€â”€ list/route.ts
â”‚   â”œâ”€â”€ details/route.ts
â”‚   â”œâ”€â”€ create/route.ts
â”‚   â””â”€â”€ update/route.ts
â”‚
â”œâ”€â”€ payments/              # â³ Ø¯ÙØ¹
â”‚   â”œâ”€â”€ initiate/route.ts
â”‚   â”œâ”€â”€ webhook/route.ts
â”‚   â””â”€â”€ create-session/route.ts
â”‚
â””â”€â”€ schedule/              # â³ Ø¬Ø¯ÙˆÙ„Ø©
    â”œâ”€â”€ generate/route.ts
    â””â”€â”€ list/route.ts
3. ğŸ“„ Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙƒÙˆÙŠÙ†
text
- tailwind.config.js       # â³ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Tailwind
- postcss.config.js        # â³ PostCSS
- next.config.js           # â³ Next.js
- package.json             # â³ dependencies
- .env.example             # â³ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
- prisma/schema.prisma     # â³ Ù…Ø®Ø·Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- prisma/seed.ts          # â³ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
ğŸ”— Ø§Ù„ØªÙƒØ§Ù…Ù„Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©
1. Ù…Ø¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
âœ… Header â† AuthContext â† API Routes

âœ… FieldCard â† API /fields/list â† Prisma

âœ… BookingSlot â† API /bookings â† Helpers

âœ… Button/Input â† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª

2. Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©:
âœ… Middleware â† Auth â† Cookies â† Database

âœ… API Routes â† Auth Headers â† Middleware

âœ… Components â† AuthContext â† Cookies

3. Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:
âœ… Helpers â† Prisma â† PostgreSQL

âœ… API Routes â† Helpers â† Business Logic

âœ… Middleware â† Auth â† Database

ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØªØ§Ù„ÙŠØ©
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
Ø¥Ù†Ø´Ø§Ø¡ prisma/schema.prisma (Ù…Ø®Ø·Ø· Ù…Ø±ÙÙ‚)

Ø¥Ø¹Ø¯Ø§Ø¯ package.json Ù…Ø¹ scripts

ØªÙƒÙˆÙŠÙ† tailwind.config.js

Ø¥Ø¹Ø¯Ø§Ø¯ .env Ùˆ.env.example

Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: API Routes Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
/api/auth/login Ùˆ/register

/api/fields/list Ùˆ/details

/api/bookings/create Ùˆ/list

Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
app/page.tsx - Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

app/fields/page.tsx - Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨

app/fields/[id]/page.tsx - ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø¹Ø¨

Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯Ø§Øª
app/dashboard/player - Ù„Ø§Ø¹Ø¨

app/dashboard/owner - Ù…Ø§Ù„Ùƒ

app/dashboard/employee - Ù…ÙˆØ¸Ù

ğŸ¯ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹
Ù„Ø¨Ø¯Ø¡ ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©:
typescript
// 1. Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©
import { Button, Card, Input } from '@/components/ui'
import Header from '@/components/layout/Header'
import Footer from '@/components/layout/Footer'
import { useAuth } from '@/context/AuthContext'

// 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… AuthContext
const { user, isLoading, login } = useAuth()

// 3. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø«ÙˆØ§Ø¨Øª
import { USER_ROLES, ERROR_MESSAGES } from '@/lib/constants'

// 4. Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API
const response = await fetch('/api/endpoint', {
  headers: { 'Content-Type': 'application/json' }
})
Ù„Ø¥Ù†Ø´Ø§Ø¡ API Route:
typescript
// 1. Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø£Ø¯ÙˆØ§Øª
import { withErrorHandler } from '@/lib/errors'
import { requireAuth } from '@/lib/auth'
import { success, badRequest } from '@/lib/responses'
import prisma from '@/lib/prisma'

// 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Error Handler
export const POST = withErrorHandler(async (req: Request) => {
  // 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
  const { user, error } = await requireAuth(req)
  if (error) return badRequest(error.message)
  
  // 4. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨
  const data = await req.json()
  
  // 5. Ø§Ø³ØªØ®Ø¯Ø§Ù… Prisma
  const result = await prisma.booking.create({ data })
  
  // 6. Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
  return success(result)
})
âš¡ Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±
1. ØªØ±ØªÙŠØ¨ Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‚ØªØ±Ø­:
Prisma Schema â† Ø§Ù„Ø£Ø³Ø§Ø³

Auth APIs â† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„/Ø®Ø±ÙˆØ¬

Fields APIs â† Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨

Home Page â† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

Booking APIs â† Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¬Ø²

2. Ø§Ø®ØªØ¨Ø§Ø± ÙƒÙ„ Ù…Ø±Ø­Ù„Ø©:
ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

Ø§Ø®ØªØ¨Ø± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (login/logout)

Ø§Ø®ØªØ¨Ø± Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø§Ø¹Ø¨

Ø§Ø®ØªØ¨Ø± Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø¬Ø²

Ø§Ø®ØªØ¨Ø± Ø§Ù„Ø¯ÙØ¹ (Paymob mock)

3. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©:
Ø§Ø³ØªØ®Ø¯Ù… withErrorHandler Ù„Ø¬Ù…ÙŠØ¹ APIs

Ø§Ø³ØªØ®Ø¯Ù… requireAuth Ù„Ù„Ø­Ù…Ø§ÙŠØ©

Ø§Ø³ØªØ®Ø¯Ù… success() ÙˆbadRequest() Ù„Ù„Ø±Ø¯ÙˆØ¯

Ø§Ø³ØªØ®Ø¯Ù… logger Ù„Ù„ØªØªØ¨Ø¹

ğŸ“ Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©
Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©:
Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©: lib/auth.ts + context/AuthContext.tsx

Ù„Ù„Ø£Ø®Ø·Ø§Ø¡: lib/errors.ts + lib/responses.ts

Ù„Ù„Ù‚ÙˆØ§Ø¹Ø¯: lib/constants.ts + types/index.ts

Ù„Ù„ØªØ³Ø¬ÙŠÙ„: lib/logger.ts

Ù„Ù„Ø­Ù…Ø§ÙŠØ©: middleware.ts + lib/rateLimit.ts

Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
typescript
// Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
verifyToken(token)
requireAuth(request, role)
setAuthCookies(access, refresh)

// Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
AppError, ValidationError, NotFoundError
handleError(error), withErrorHandler(handler)

## **âœ… Ù…Ù„Ø®Øµ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²**

ØªÙ… Ø¨Ù†Ø§Ø¡ **Ù†Ø¸Ø§Ù… Ø£Ø³Ø§Ø³ÙŠ ÙƒØ§Ù…Ù„** ÙŠØ´Ù…Ù„:

1. **ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… Ù…ØªÙƒØ§Ù…Ù„Ø©** Ù…Ø¹ 10+ Ù…ÙƒÙˆÙ†Ø§Øª Ø¬Ø§Ù‡Ø²Ø©
2. **Ù†Ø¸Ø§Ù… Ù…ØµØ§Ø¯Ù‚Ø© Ù…ØªÙ‚Ø¯Ù…** Ù…Ø¹ JWT ÙˆCookies
3. **Ø¥Ø¯Ø§Ø±Ø© Ø£Ø®Ø·Ø§Ø¡ Ù…ÙˆØ­Ø¯Ø©** Ù…Ø¹ 8 Ø£Ù†ÙˆØ§Ø¹ Ø£Ø®Ø·Ø§Ø¡
4. **Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ù…Ø­ÙÙˆØ¸Ø§Øª** Ù…Ø¹ Daily Rotate
5. **Ø­Ù…Ø§ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø©** Ù…Ø¹ Middleware ÙˆRate Limiting
6. **Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© Ø´Ø§Ù…Ù„Ø©** Ù„Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚
7. **Ø«ÙˆØ§Ø¨Øª ÙˆØ£Ù†ÙˆØ§Ø¹** ÙƒØ§Ù…Ù„Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
8. **ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨** Ù…Ø¹ Tailwind CSS

**ÙƒÙ„ Ù…Ø§ ØªØ¨Ù‚Ù‰ Ù‡Ùˆ:** ØµÙØ­Ø§Øª Next.js ÙˆAPI Routes Ø§Ù„ØªÙŠ Ø³ØªØ³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©.


**ğŸ¯ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡ ÙÙŠ ÙƒØªØ§Ø¨Ø© Ø§Ù„ØµÙØ­Ø§Øª ÙˆAPIs!** ğŸš€
